3-way handshaking 

    <Client>                           <Server>
        |                                 |                                                  
  [SYN] | ------------------------------> |  
        | <------------------------------ | [SYSACK]
  [ACK] | ------------------------------> |  
        |                                 |                                                  
 
 
Message format 
        +-------+-------+-------+-------+-------+-------+-------+-------+ 0x00
        |       "AAAA"                  | m_size        | flag  |  "B"  | ; flag = 0x21 or 0x11
        +-------+-------+-------+-------+-------+-------+-------+-------+
        |                                                               | 
        |                               sender ip                       | 0x10
        |                                                               |
        +-------+-------+-------+-------+-------+-------+-------+-------+ 
        |                                                               |
        |                               dest ip                         | 0x20
        |                                                               |
        +-------+-------+-------+-------+-------+-------+-------+-------+

        +-------+-------+-------+-------+-------+-------+-------+-------+
        |      check    |PORT or frgmt* |       size    |       "bb"    | ; if flag = 0x21 : PORT else : frgmt
        +-------+-------+-------+-----|-+-------+-------+-------+-------+
        +                             |
        [ MESSAGE ]                   |                                                                        
                                      |                                                             
                                      |                                                             
                                      |                                                             
         /----------------------------/                                                                                                                                        
         |                         
         |          +-------+-------+                                                          
         \------->  |              *|                                                          
                    +-------+------|+
                                   |  
                                   \-----> last_packet (last bit)                                                          
                       
                    |<------------->|
                        frgmt 0xf8 ------> size                         
                              
        
Fragmentation info table 0x804e160 (0x34 52 bytes)
    
    1) create info 

        +-------+-------+-------+-------+-------+-------+-------+-------+ 0x00
    /---|-----* size    |       "bb"    |                               | 
    |   +-------+-------+-------+-------+                               | 
    |   |                                send ip                        |   
    |   |                               +-------+-------+-------+-------+ 0x10
    |   |                               |                               |
    |   +-------+-------+-------+-------                                | 
    |   |                             dest ip                           |
    |   |                               +-------+-------+-------+-------+ 0x20
    |   |                               |          next buffer *--------|-----------\
    |   +-------+-------+-------+-------+-------+-------+-------+-------+           |
    |   |  v_length-40  |      D/C      |           time(0)             |           |
    |   +-------+-------+-------+-------+-------+-------+-------+-------+ 0x30      |
    |   |             ptr               |                                           |
    |   +-------+-------+-------+-------+                                           |
    |                                                                               |
    \--> variable length : (frgmt&0xff80) + (m_size-8) + 40                         |
                                                                                    |
        /---------------------------------------------------------------------------/ 
        |
        V                                                                                  
        +-------+-------+-------+-------+-------+-------+-------+-------+
        |       "AAAA"                  | m_size        | flag  |  "B"  | ; m_szie -> (variable_length - 40)
        +-------+-------+-------+-------+-------+-------+-------+-------+
        |                                                               |
        |                               sender ip                       |
        |                                                               |
        +-------+-------+-------+-------+-------+-------+-------+-------+
        |                                                               |
        |                               dest ip                         |
        |                                                               |
        +-------+-------+-------+-------+-------+-------+-------+-------+
        +
        [ (frgmt&0xff80) ] 
        + 
        [ MESSAGE ] 


                           
[     header     ]     [     header     ]    [     header     ]           [     header     ]   
[     sender ip  ]     [     sender ip  ]    [     sender ip  ]           [     sender ip  ]   
[     sender ip  ]     [     sender ip  ]    [     sender ip  ]           [     sender ip  ]   
[     dest ip    ]     [     dest ip    ]    [     dest ip    ]           [     dest ip    ]   
[     dest ip    ]     [     dest ip    ]    [     dest ip    ]           [     dest ip    ]   
[                ]     [                ]    [                ]   ---->   [ last fragemnted]   
[                ]     [                ]    [                ]           [                ]   
...                    ...                   ...                          ...                  
[                ]     [                ]    [ 3rd fragmented ]           [ 3rd fragmented ]   
[                ]     [ 2nd fragmented ]    [ 2nd fragmented ]           [ 2nd fragmented ]   
[ 1st fragmented ]     [ 1st fragmented ]    [ 1st fragmented ]           [ 1st fragmented ]   


    2) update info 


session info table  0x804e170 (0x54 84 bytes)

        +-------+-------+-------+-------+-------+-------+-------+-------+ 0x00
        |                                                               |
        |-------+-------+-------+-------+-------------------------------+
        |           rand()              |                               |
        +-------+-------+-------+-------+                               | 0x10
        |                             addr                              |
        |                               +-------+-------+-------+-------+ 
        |                               |                               |
        +-------+-------+-------+-------+-------+-------+-------+-------+ 0x20
        |                                                               |
        |                               sender ip                       |
        |                                                               |
        +-------+-------+-------+-------+-------+-------+-------+-------+ 0x30
        |                                                               |
        |                               dest ip                         |
        |                                                               |
        +-------+-------+-------+-------+-------+-------+-------+-------+ 0x40
        |      msg      |     PORT      |             rand()            | 
        +-------+-------+-------+-------+-------+-------+-------+-------+
        |            time(0)            | state |                       |
        +-------+-------+-------+-------+-------+-------+-------+-------+ 0x50
        |           ptr                 |
        +-------+-------+-------+-------+












gdb$ x/2i snprintf
   0x8048c60 <snprintf@plt>:	jmp    DWORD PTR ds:0x804e09c




